import{d as Q,r as M,b as Z,w as z,e as m,a as L,c as W,f as u,g as H,i as B,h as G,v as j,t as U,j as g,m as T}from"./index.4b015a66.js";const D=[{nome:"Spacca-Stelle I",classe:"Stardestroyer",armi:["Lsr","knt"],piantaNave:"testImage.png"},{nome:"Curiosity",classe:"Science-Ship",armi:["PDC"],piantaNave:"testImage2.png"}],O=[{nome:"Laser",codice:"Lsr",tipo:"arma energetica",danno:10},{nome:"Kinetic Battery",codice:"knt",tipo:"arma cinetica",danno:1e3},{nome:"Point-Defence-Cannon",codice:"PDC",tipo:"arma cinetica",danno:100}],ee={class:"container"},te={class:"row"},le={class:"mb-4"},oe=u("h2",{class:"text-center"},"Scegli un attaccante",-1),ne={class:"mb-4"},se=u("h2",null,"Dettagli personaggio",-1),re=u("span",{class:"h4"},"Nome:",-1),ce=T(),he={class:"ps-3"},de=u("span",{class:"h4"},"Classe:",-1),ie=T(),ue={class:"ps-3"},fe=u("span",{class:"h4"},"Armi:",-1),ae={key:0},ve={key:1},pe={class:"form-check"},_e=u("label",{class:"form-check-label",for:"attackerAllWeaponsCheckbox"},"Mostra tutte le armi",-1),ye={class:"col"},we=u("h1",{id:"titoloNave"},"Nave",-1),be={class:"col"},ke=u("h1",{id:"danniNave"},"Danni",-1),Se={id:"battle button"},Ne=Q({__name:"NavalCalculatorView",setup(xe){const k=M(void 0),I=M(void 0),$=M(void 0);M(void 0);const N=M(void 0),V=M(void 0),A=M(null);M([]);const P=M(!1),E=Z(()=>{var r;if(A.value==null)return[];if(P.value)return O;const e=[];return(r=A.value)==null||r.armi.forEach(s=>{const i=O.find(l=>l.codice==s);i!==void 0&&e.push(i)}),e}),R=M(null);z(A,()=>{var e;R.value=E.value[0],Y((e=A.value)==null?void 0:e.piantaNave,function(r,s,i,l){X(r,s,i,l)})});function F(e,r,s){if(!e)return;let i=e.map(y=>[...y.map(d=>[...d])]),l=r,n=r,p=100,v=.05,S=[v*Math.cos(s),v*Math.sin(s)],a=!1;for(l=l.map((y,d)=>y+S[d]);0<=l[0]&&l[0]<=1*e[3][0].length&&0<=l[1]&&l[1]<=1*e[3].length&&p>0;){const[y,d]=[Math.floor(l[0]),Math.floor(l[1])],[f,w]=[Math.floor(n[0]),Math.floor(n[1])];i[3][d][y]==1&&((y>f||y<f||d<w||d>w)&&(i[3][d][y]=-1,a=!0),a&&(p-=.1,a=!1)),n=[...l],l=l.map((C,x)=>C+S[x])}return i}function K(e,r,s,i){if(!e)return;let l=e.map(t=>[...t.map(o=>[...o])]),n=r,p=r,v=100,S=.05,a=[S*Math.cos(s),S*Math.sin(s)],y=!1,d=!1,f=0,w=[];const C=(t,o,h,c)=>{const _=[t[0][o][h],t[1][o][h],t[2][o][h]];return _[0]===c[0]&&_[1]===c[1]&&_[2]===c[2]||x(t,o,h,c,_),t},x=(t,o,h,c,_)=>{t[0][o][h]!==_[0]||t[1][o][h]!==_[1]||t[2][o][h]!==_[2]||(t[0][o][h]=c[0],t[1][o][h]=c[1],t[2][o][h]=c[2],x(t,o-1,h,c,_),x(t,o+1,h,c,_),x(t,o,h-1,c,_),x(t,o,h+1,c,_))};for(n=n.map((t,o)=>t+a[o]);0<=n[0]&&n[0]<=1*e[3][0].length&&0<=n[1]&&n[1]<=1*e[3].length&&v>0;){const[t,o]=[Math.floor(n[0]),Math.floor(n[1])],[h,c]=[Math.floor(p[0]),Math.floor(p[1])];l[3][o][t]==1?(t>h||t<h||o<c||o>c)&&(l[3][o][t]=-1,w[f]=[o,t],y=!0):l[3][o][t]==2&&(t>h||t<h||o<c||o>c)&&(l[3][o][t]=-2-f,w[f]=[o,t],d=!0),y?(v-=10,f+=1,y=!1):d&&(v-=2,f+=1,d=!1),p=[...n],n=n.map((_,b)=>_+a[b])}return f=0,w.forEach((t,o)=>{l[3][w[o][0]][w[o][1]]===-1?f=0:f+=1,f>10&&(l=C(l,w[o][0],w[o][1],[204,204,0])),f>20&&(l=C(l,w[o][0],w[o][1],[204,0,0]))}),l}function X(e,r,s,i){var C,x;const l=(C=k.value)==null?void 0:C.getContext("2d"),n=(x=I.value)==null?void 0:x.getContext("2d"),p=50,v=t=>20+t*i,S=t=>(t-20)/i,a=t=>t/360*Math.PI*2,y=(t,o,h)=>{!l||(l.fillStyle=h,l.fillRect(v(o),v(t),s,s))},d=(t,o,h)=>{!n||(n.fillStyle=h,n.fillRect(v(o),v(t),s,s))};let f=null;k.value&&(k.value.onmousedown=t=>{f=[S(t.offsetX),S(t.offsetY)],w()}),V.value&&(V.value.onclick=t=>{w()}),N.value&&(N.value.oninput=t=>{w()});const w=()=>{if(!l||!n||!k.value||!N.value)return;l.fillStyle="Grey",l.fillRect(0,0,k.value.width,k.value.height),n.fillStyle="Grey",n.fillRect(0,0,k.value.width,k.value.height);let t=[],o=[];if(f===null||N.value===null?(t=e,o=r):(t=F(e,f,a(parseInt(N.value.value))),o=K(r,f,a(parseInt(N.value.value)))),!(!t||!o)&&(t[3].forEach((h,c)=>{h.forEach((_,b)=>{if(!!t)switch(_){case 0:y(c,b,"white");break;case 1:y(c,b,`rgb(${t[0][c][b]}, ${t[1][c][b]}, ${t[2][c][b]})`);break;case-1:y(c,b,"rgb(100, 100, 100)")}})}),o[3].forEach((h,c)=>{h.forEach((_,b)=>{if(!!o)switch(Math.abs(_)){case 0:d(c,b,"white");break;case 2:d(c,b,`rgb(${o[0][c][b]}, ${o[1][c][b]}, ${o[2][c][b]})`);break;case 1:d(c,b,"black")}})}),f!=null)){console.log(f);const h=[v(f[0]),v(f[1])],c=Number(N.value)/360*Math.PI*2;l.strokeStyle="white",l.lineWidth=2,l.beginPath(),l.moveTo(h[0],h[1]),l.lineTo(h[0]+Math.cos(c)*p,h[1]+Math.sin(c)*p),l.stroke()}};N.value,w()}function Y(e,r){var s=new Image;const i=15,n=i+2;/^data/.test(e)||(s.crossOrigin="");let p=[];s.src=e,s.onload=function(){if(p=q(s,n),!p)return;let v=p.map(S=>[...S.map(a=>[...a])]);p[3].forEach((S,a)=>{S.forEach((y,d)=>{!p||(p[0][a][d]===0&&p[1][a][d]===0&&p[2][a][d]===0?v[3][a][d]=1:p[3][a][d]===0?v[3][a][d]=0:(v[0][a][d]=0,v[1][a][d]=255,v[2][a][d]=85,v[3][a][d]=2))})}),r(p,v,i,n)}}function q(e,r){var l;const s=(l=$.value)==null?void 0:l.getContext("2d");let i=[];if(k.value!=null&&I.value!=null&&(k.value.width=e.width*r+40,k.value.height=e.height*r+40,I.value.width=e.width*r+40,I.value.height=e.height*r+40),s==null||s.drawImage(e,0,0),e.width!==0&&e.height!==0){const n=s==null?void 0:s.getImageData(0,0,e.width,e.height);i=J(n)}return i}function J(e){let r=0,s=0,i=[Array(e==null?void 0:e.height).fill(void 0).map(()=>Array(e==null?void 0:e.width).fill(void 0)),Array(e==null?void 0:e.height).fill(void 0).map(()=>Array(e==null?void 0:e.width).fill(void 0)),Array(e==null?void 0:e.height).fill(void 0).map(()=>Array(e==null?void 0:e.width).fill(void 0)),Array(e==null?void 0:e.height).fill(void 0).map(()=>Array(e==null?void 0:e.width).fill(void 0))];for(var l=0;l<3;l++){if(!(e!=null&&e.width))return;for(var n=l;n<e.data.length;n+=4)i[l][s][r]=e==null?void 0:e.data[n],(e==null?void 0:e.data[n])!==255&&(e==null?void 0:e.data[n+1])!==255&&(e==null?void 0:e.data[n+2])!==255&&l==0?i[3][s][r]=1:l!=1&&l!=2&&(i[3][s][r]=0),r==e.width-1&&(r=-1,s++),r++;s=0}return i}return(e,r)=>{var i,l;const s=m("v-select");return L(),W("div",ee,[u("div",te,[u("div",le,[oe,H(s,{options:B(D),label:"nome",modelValue:A.value,"onUpdate:modelValue":r[0]||(r[0]=n=>A.value=n)},null,8,["options","modelValue"])]),G(u("div",ne,[se,u("div",null,[re,ce,u("span",he,U((i=A.value)==null?void 0:i.nome),1)]),u("div",null,[de,ie,u("span",ue,U((l=A.value)==null?void 0:l.classe),1)]),fe,B(E).length===0?(L(),W("div",ae,"La Nave non ha armi")):(L(),W("div",ve,[H(s,{options:B(E),label:"nome",modelValue:R.value,"onUpdate:modelValue":r[1]||(r[1]=n=>R.value=n)},null,8,["options","modelValue"])])),u("div",pe,[G(u("input",{class:"form-check-input",type:"checkbox",value:"",id:"attackerAllWeaponsCheckbox","onUpdate:modelValue":r[2]||(r[2]=n=>P.value=n)},null,512),[[g,P.value]]),_e])],512),[[j,A.value]]),u("div",ye,[we,u("canvas",{ref_key:"CanvasShip",ref:k},null,512),u("input",{type:"range",min:"-180",max:"180",value:"0",class:"slider",id:"slider",ref_key:"slider",ref:N},null,512)]),u("div",be,[ke,u("canvas",{ref_key:"CanvasDamage",ref:I},null,512)]),u("div",Se,[u("input",{type:"button",id:"button",ref_key:"button",ref:V,value:"Initiate Battle"},null,512)]),u("canvas",{ref_key:"CanvasLoad",ref:$},null,512)])])}}});export{Ne as default};
